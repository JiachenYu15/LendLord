
<%= render "layouts/single_header" %>

<div class="w3-light-grey" style="margin-top:77px; margin-bottom: 16px; max-width: 1400px;">
    <div class="w3-row-padding">
        <div class="w3-third">
            <div class="w3-card-4">
                <div class="w3-display-container">
                    <%= image_tag("/assets/test_profile.jpg", size:"350x233", style:'width: 100%;') %>
                </div>

                <h1 class="w3-padding-16">Welcome <%= @user.username %></h1>
                <p><i class="fa fa-user-circle fa-fw w3-margin-right w3-large w3-text-teal"></i><%=@user.fname%> <%=@user.lname%></p>
                <p><i class="fa fa-home fa-fw w3-margin-right w3-large w3-text-teal"></i><%=@user.address%></p>
                <p><i class="fa fa-envelope fa-fw w3-margin-right w3-large w3-text-teal"></i><%=@user.email%></p>
                <p><i class="fa fa-phone fa-fw w3-margin-right w3-large w3-text-teal"></i><%=@user.cell_number%></p>

            </div>
            <br>
            <div class="w3-card-4">

                <h1 class="w3-padding-16">Notifications</h1>

            </div>
        </div>

        <div class="w3-twothird">
            <div class="w3-card" style="margin-bottom:16px !important; min-height: 300">
                <h2 class="w3-padding-16"><i class="fa fa-fw fa-sign-out w3-margin-right w3-text-teal"></i>Recent Lending</h2>
                <%= link_to "Post New Item", new_item_path %>
                <% if @lend.size != 0 %>
                    <table>
                        <tr>
                          <th>Transaction ID</th>
                          <th>Item Name</th>
                          <th>Borrower</th>
                          <th>Start Date</th>
                          <th>Due Date</th>
                          <th>Deposit</th>
                          <th>Status</th>
                          <th>Action</th>
                        </tr>
                     
                        <% @lend.each do |transaction| %>
                          <tr>
                            <td><%= transaction.id %></td>
                            <td><%= transaction.item.name %></td>
                            <td><%= transaction.user.username %></td>
                            <td><%= transaction.start_date %></td>
                            <td><%= transaction.due_date %></td>
                            <td><%= transaction.deposit %></td>
                            <td><%= transaction.status %></td>
                            <td><%= link_to 'Show', transaction_path(transaction) %></td>
                            <!--
                            <td><%= link_to 'Edit', edit_transaction_path(transaction) %></td>
                            <td><%= link_to 'Destroy', transaction_path(transaction),
                                            method: :delete,
                                            data: { confirm: 'Are you sure?' } %></td>
                            -->
                          </tr>
                        <%end%>
                    </table>
                <%else%>
                      <br><i>You didn't lend anything recently.</i>
                      <br><br>
                <%end%>
            </div>

            <div class="w3-card" style="margin-bottom:16px !important; min-height: 300">
                <h2 class="w3-padding-16"><i class="fa fa-fw fa-sign-in w3-margin-right w3-text-teal"></i>Recent Borrowing</h2>
                <%= link_to "Borrow Now", root_path %>
                <% if @borrow.size != 0 %>
                    <table>
                        <tr>
                          <th>Transaction ID</th>
                          <th>Item Name</th>
                          <th>Owner</th>
                          <th>Start Date</th>
                          <th>Due Date</th>
                          <th>Deposit</th>
                          <th>Status</th>
                          <th>Action</th>
                        </tr>
                     
                        <% @borrow.each do |transaction| %>
                          <tr>
                            <td><%= transaction.id %></td>
                            <td><%= transaction.item.name %></td>
                            <td><%= transaction.item.user.username %></td>
                            <td><%= transaction.start_date %></td>
                            <td><%= transaction.due_date %></td>
                            <td><%= transaction.deposit %></td>
                            <td><%= transaction.status %></td>
                            <td><%= link_to 'Show', transaction_path(transaction) %></td>
                            <!--
                            <td><%= link_to 'Edit', edit_transaction_path(transaction) %></td>
                            <td><%= link_to 'Destroy', transaction_path(transaction),
                                            method: :delete,
                                            data: { confirm: 'Are you sure?' } %></td>
                            -->
                          </tr>
                        <%end%>
                    </table>
                <%else%>
                      <br><i>You didn't borrow anything recently.</i>
                      <br><br>
                <%end%>
            </div>
            
            <div class="w3-card">
                <h2 class="w3-padding-16"><i class="fa fa-fw fa-users w3-margin-right w3-text-teal"></i>Friend Requests</h2>
                <%= link_to "Add New Friend", new_friend_path%>
                <% unless @awaitfriends.blank? %>
                    <tr><table>
                      <tr>
                        <th>Username</th>
                        <th>Received on</th>
                        <th>Options</th>
                      </tr>
                      <% @awaitfriends.each do |f| %>
                        <tr>
                          <td><%= f["username"] %></td>
                          <td><%= f["drecv"] %></td>
                          <td>
                            &nbsp<%= link_to "Accept", accept_friend_path(f["id"]) %>&nbsp|
                            <%= link_to "Reject", reject_friend_path(f["id"]) %>&nbsp
                          </td>
                        </tr>
                      <% end %>
                    </table></tr>
                    <% else %>
                      <br><i>You currently don't have pending received friend requests</i>
                      <br><br>
                    <% end %>

            </div>
        </div>
    </div>
</div>

<%= render "layouts/footer" %>

<style>
table{
    border: solid 1px;
    width:100%;
}

td{
    border: solid 1px;
    width: auto;
    text-align: center;
}

th{
    border: solid 1px;
    width: auto;
    text-align: center;
}

a{
    color: #f9be37;
}

</style>
